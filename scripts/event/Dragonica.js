/* ==================
 脚本类型: 脚本
 版权：游戏盒团队     
 联系扣扣：297870163    609654666
 =====================
 */var minPlayers=3;function init(){em.setProperty("state","0");em.setProperty("leader","true")}function setup(a,b){em.setProperty("state","1");em.setProperty("leader","true");a=em.newInstance("Dragonica"+b);a.setInstanceMap(240080600).resetFully();a.setInstanceMap(240080700);var c=a.setInstanceMap(240080800);c.resetFully();a.setInstanceMap(240080040);var d=em.getMonster(8300007);a.registerMonster(d);c.spawnMonsterOnGroundBelow(d,new java.awt.Point(700,-10));a.startEventTimer(36E5);return a}function playerEntry(a,b){var c=a.getMapInstance(0);b.changeMap(c,c.getPortal(0))}function playerRevive(a,b){var c=a.getMapInstance(3);b.addHP(50);b.changeMap(c,c.getPortal(0));return!0}function scheduledTimeout(a){end(a)}function changedMap(a,b,c){240080600!=c&&240080700!=c&&240080800!=c&&240080040!=c&&(a.unregisterPlayer(b),c=em.getChannelServer().getMapFactory().getMap(240080050),b.changeMap(c,c.getPortal(0)),a.disposeIfPlayerBelow(0,0)&&(em.setProperty("state","0"),em.setProperty("leader","true")))}function playerDisconnected(a,b){return 0}function monsterValue(a,b){return 1}function playerExit(a,b){a.unregisterPlayer(b);a.disposeIfPlayerBelow(0,0)&&(em.setProperty("state","0"),em.setProperty("leader","true"))}function end(a){a.disposeIfPlayerBelow(100,240080050);em.setProperty("state","0");em.setProperty("leader","true")}function clearPQ(a){end(a)}function allMonstersDead(a){0==a.getMapInstance(2).getAllMonstersThreadsafe().size()&&(a.getMapInstance(2).spawnNpc(2085003,new java.awt.Point(700,-10)),a.broadcastPlayerMsg(6,"\u68a6\u5e7b\u9f99\u65cf\u53c8\u88ab\u6bb4\u6253\uff01\u8ba9\u961f\u957f\u8fdb\u5165\u95e8\u5b8c\u6210!"))}function leftParty(a,b){a.getPlayers().size()<minPlayers?end(a):playerExit(a,b)}function disbandParty(a){end(a)}function playerDead(a,b){}function cancelSchedule(){};