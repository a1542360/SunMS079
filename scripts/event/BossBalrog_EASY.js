/* ==================
 脚本类型: 脚本
 版权：游戏盒团队     
 联系扣扣：297870163    609654666
 =====================
 */var fullhp=6E6;function init(){em.setProperty("state","0");em.setProperty("balrogState","0");em.setProperty("leader","true")}function setup(a,b){em.setProperty("state","1");em.setProperty("balrogState","0");em.setProperty("leader","true");a=em.newInstance("BossBalrog_EASY"+b);a.setInstanceMap(105100300).resetFully();a.setInstanceMap(105100301).resetFully();a.schedule("spawn",5E3);a.schedule("checkHP",305E3);return a}function spawn(a){var b=a.getMapInstance(0),c=em.getMonster(8830007),e=em.getMonster(8830001),d=em.getMonster(8830009),f=em.newMonsterStats();f.setOHp(fullhp);f.setOMp(c.getMobMaxMp());var g=em.newMonsterStats();g.setOHp(fullhp);g.setOMp(e.getMobMaxMp());var h=em.newMonsterStats();h.setOHp(fullhp);h.setOMp(d.getMobMaxMp());c.setOverrideStats(f);e.setOverrideStats(g);d.setOverrideStats(h);a.registerMonster(c);a.registerMonster(e);a.registerMonster(d);b.spawnMonsterOnGroundBelow(c,new java.awt.Point(412,258));b.spawnMonsterOnGroundBelow(e,new java.awt.Point(412,258));b.spawnMonsterOnGroundBelow(d,new java.awt.Point(412,258));a.startEventTimer(12E5)}function playerEntry(a,b){var c=a.getMapInstance(0);b.changeMap(c,c.getPortal(0));a.applyBuff(b,2022536);b.haveItem(1302014)&&a.applyBuff(b,2022537)}function changedMap(a,b,c){105100300!=c&&105100301!=c&&playerExit(a,b)}function playerExit(a,b){a.unregisterPlayer(b);b.dispelBuff(2022536);b.dispelBuff(2022537);a.disposeIfPlayerBelow(0,0)&&(em.setProperty("state","0"),em.setProperty("leader","true"),em.setProperty("balrogState","0"))}function scheduledTimeout(a){end(a)}function allMonstersDead(a){}function warpWinnersOut(a){var b=a.getPlayers();a=a.getMapInstance(1);for(var c=0;c<b.size();c++)b.get(c).changeMap(a,a.getPortal(0)),b.get(c).dispelBuff(2022536),b.get(c).dispelBuff(2022537),b.get(c).forceCompleteQuest(2241),b.get(c).forceCompleteQuest(2242),b.get(c).forceCompleteQuest(2243),b.get(c).forceCompleteQuest(2244),b.get(c).forceCompleteQuest(2245)}function playerDead(a,b){}function playerRevive(a,b){return!1}function playerDisconnected(a,b){return 0}function monsterValue(a,b){em.getProperty("balrogState").equals("1")&&null==a.getMapInstance(0).getMonsterById(8830007)&&null==a.getMapInstance(0).getMonsterById(8830008)&&null==a.getMapInstance(0).getMonsterById(8830009)&&(a.broadcastPlayerMsg(6,"Balrog has been beaten!"),a.getMapInstance(0).changeEnvironment("balog/clear/stone",3),a.restartEventTimer(605E3),a.schedule("warpWinnersOut",5E3));return 1}function leftParty(a,b){}function disbandParty(a,b){}function end(a){a.disposeIfPlayerBelow(100,105100100);em.setProperty("state","0");em.setProperty("leader","true");em.setProperty("balrogState","0")}function clearPQ(a){end(a)}function removePlayer(a,b){}function registerCarnivalParty(a,b){}function onMapLoad(a,b){}function cancelSchedule(){}function checkHP(a){for(var b=a.getMapInstance(0),c=b.getAllMonstersThreadsafe(),e=0,d=0;d<c.size();d++)e+=fullhp-c.get(d).getHp();12E4<e?(c=em.getMonster(8830013),a.registerMonster(c),b.spawnMonsterOnGroundBelow(c,new java.awt.Point(416,258)),b.killMonster(8830001),b.killMonster(8830013),c=em.getMonster(8830007),e=em.getMonster(8830008),d=em.getMonster(8830009),a.registerMonster(c),a.registerMonster(e),a.registerMonster(d),b.killMonster(8830007),b.killMonster(8830009),b.spawnMonsterOnGroundBelow(c,new java.awt.Point(416,258)),b.spawnMonsterOnGroundBelow(e,new java.awt.Point(416,258)),b.spawnMonsterOnGroundBelow(d,new java.awt.Point(416,258)),em.setProperty("balrogState","1")):(a.broadcastPlayerMsg(6,"\u624e\u6606\u592a\u5f3a\uff0c\u6d88\u706d\u4e86\u4f60."),end(a))};